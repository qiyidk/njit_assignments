
CREATE TABLE PUBLISHER
(   PUBLISHERID INTEGER PRIMARY KEY,
    PUBNAME VARCHAR(64) NOT NULL,
    ADDRESS VARCHAR(64)
);

CREATE TABLE DOCUMENT
(   DOCID INTEGER PRIMARY KEY,
    TITLE VARCHAR(200) NOT NULL,
    PDATE DATE,
    PUBLISHERID INTEGER,
    FOREIGN KEY (PUBLISHERID) REFERENCES PUBLISHER(PUBLISHERID)
);

CREATE TABLE BOOK
(   DOCID INTEGER PRIMARY KEY,
    ISBN VARCHAR(64),
    FOREIGN KEY (DOCID) REFERENCES DOCUMENT(DOCID)
);

CREATE TABLE AUTHOR
(   AUTHORID INTEGER PRIMARY KEY,
    ANAME VARCHAR(64) NOT NULL
);

CREATE TABLE PROCEEDINGS
(   DOCID INTEGER PRIMARY KEY,
    CDATE DATE,
    CLOCATION VARCHAR(64),
    CEDITOR VARCHAR(64),
    FOREIGN KEY (DOCID) REFERENCES DOCUMENT(DOCID)
);

CREATE TABLE WRITES
(   AUTHORID INTEGER,
    DOCID INTEGER,
    PRIMARY KEY (AUTHORID, DOCID),
    FOREIGN KEY (AUTHORID) REFERENCES AUTHOR(AUTHORID),
    FOREIGN KEY (DOCID) REFERENCES BOOK(DOCID)
);

CREATE TABLE CHIEF_EDITOR
(   EDITORID INTEGER PRIMARY KEY,
    ENAME VARCHAR(64)
);

CREATE TABLE JOURNAL_VOLUME
(   DOCID INTEGER PRIMARY KEY,
    VOLUMENO INTEGER,
    EDITORID INTEGER,
    FOREIGN KEY (DOCID) REFERENCES DOCUMENT(DOCID),
    FOREIGN KEY (EDITORID) REFERENCES CHIEF_EDITOR(EDITORID)
);

CREATE TABLE JOURNAL_ISSUE
(   DOCID INTEGER,
    ISSUENO INTEGER,
    SCOPE VARCHAR(100),
    PRIMARY KEY (DOCID, ISSUENO),
    FOREIGN KEY (DOCID) REFERENCES JOURNAL_VOLUME(DOCID)
);

CREATE TABLE INV_EDITOR
(   DOCID INTEGER,
    ISSUE_NO INTEGER,
    IENAME VARCHAR(64),
    PRIMARY KEY (DOCID, ISSUE_NO),
    FOREIGN KEY (DOCID, ISSUE_NO) REFERENCES JOURNAL_ISSUE (DOCID, ISSUENO)
);

CREATE TABLE BRANCH
(   LIBID INTEGER PRIMARY KEY,
    NAME VARCHAR(64),
    LOCATION VARCHAR(64)
);

CREATE TABLE COPY
(   DOCID INTEGER,
    COPYNO INTEGER,
    LIBID INTEGER,
    POSITION VARCHAR(6),
    PRIMARY KEY (DOCID, LIBID, COPYNO),
    FOREIGN KEY (DOCID) REFERENCES DOCUMENT (DOCID),
    FOREIGN KEY (LIBID) REFERENCES BRANCH (LIBID)
);

CREATE TABLE READER
(   READERID INTEGER PRIMARY KEY,
    TYPE VARCHAR(16),
    READERNAME VARCHAR(64) NOT NULL UNIQUE,
    PHONE VARCHAR(16),
    ADDRESS VARCHAR(64),
    PASSWORD VARCHAR(16) NOT NULL
);
CREATE TABLE BORROWS
(   BORNUMBER INTEGER auto_increment PRIMARY KEY,
    READERID INTEGER,
    DOCID INTEGER,
    LIBID INTEGER,
    COPYNO INTEGER,
    BDATE DATETIME NOT NULL,
    RDATE DATETIME DEFAULT NULL,
    INDEX (DOCID, LIBID, COPYNO),
    FOREIGN KEY (READERID) REFERENCES READER (READERID),
    FOREIGN KEY (DOCID, LIBID, COPYNO) REFERENCES COPY (DOCID, LIBID, COPYNO)
);

CREATE TABLE RESERVES
(   RESNUMBER INTEGER auto_increment PRIMARY KEY,
    READERID INTEGER,
    DOCID INTEGER,
    LIBID INTEGER,
    COPYNO INTEGER,
    DDATE DATETIME NOT NULL,
    INDEX (DOCID, LIBID, COPYNO),
    FOREIGN KEY (READERID) REFERENCES READER (READERID),
    FOREIGN KEY (DOCID, LIBID, COPYNO) REFERENCES COPY (DOCID, LIBID, COPYNO)
);
